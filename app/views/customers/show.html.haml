%title
  Unwinders
  |
  = "#{@customer.name}"
/ %ul.navigation
/   %li
/     %a{:title => "Home", :style => "background-image:url(#{asset_path("unwinders/home.jpg")});background-size:100%;background-repeat:no-repeat", :href => user_unwinders_path}
/   %li
/     %a.active{:title => "Personal Information", :style => "background-image:url(#{asset_path("unwinders/personal_information.jpg")});background-size:100%;background-repeat:no-repeat", :href => '#'}
/   %li
/     %a{:title => "Requests", :style => "background-image:url(#{asset_path("unwinders/request.jpg")});background-size:100%;background-repeat:no-repeat", :href => package_requests_customer_path(current_user.customer)}
/   %li
/     %a{:title => "History", :style => "background-image:url(#{asset_path("unwinders/history.jpg")});background-size:100%;background-repeat:no-repeat", :href => history_customer_path(current_user.customer)}
/   %li
/     %a{:title => "Edit Info", :style => "background-image:url(#{asset_path("unwinders/edit_info.jpg")});background-size:100%;background-repeat:no-repeat", :href => edit_customer_path(current_user.customer)}
#customer-profile
  - model_class = Customer
  .row
    #profile.span7.offset2{:style => 'padding:20px;background:white'}
      %h2 Personal Information
      %ul.account-info
        %li
          %label= model_class.human_attribute_name(:name)
          %span
            &nbsp;
            = best_in_place @customer, :name
        %li
          %label= model_class.human_attribute_name(:address_1)
          %span
            &nbsp;
            = best_in_place @customer, :address_1
        %li
          %label= model_class.human_attribute_name(:address_2)
          %span
            &nbsp;
            = best_in_place @customer, :address_2
        %li
          %label= model_class.human_attribute_name(:city)
          %span
            &nbsp;
            = best_in_place @customer, :city
        %li
          %label= model_class.human_attribute_name(:state)
          %span
            &nbsp;
            = best_in_place @customer, :state
        %li
          %label= model_class.human_attribute_name(:country)
          %span
            &nbsp;
            = best_in_place @customer, :country, type: :select, collection: (ActionView::Helpers::FormOptionsHelper::COUNTRIES.zip(ActionView::Helpers::FormOptionsHelper::COUNTRIES))
        %li
          %label Landline
          %span
            &nbsp;
            = best_in_place @customer, :lphone
        %li
          %label Mobile Number
          %span
            &nbsp;
            = best_in_place @customer, :mphone
  .row
    .current_user_requests
      = render :partial => 'current_requests'
  .row
    #header-history.span7.offset2{:style => 'padding:20px;background:white'}
      %h2 History
      - if !@cust_iti_headers.present?
        .well{:style => 'margin-top:20px;text-align:center'}
          %h3
            No trips to show.
            = link_to "Request", user_unwinders_path
            a package soon!
      - else
        .portfolio
          %ul.grid
            - @cust_iti_headers.each do |h|
              %li
                %a{:href => history_cust_iti_header_path(:id => h.id)}
                  .img-with-text
                    %img{:src => "#{h.cust_iti_details.last.destination.image.url(:square) rescue nil}", :alt => "No image"}
                    %p
                      - last_index = h.cust_iti_details.length - 1
                      - h.cust_iti_details.each_with_index do |d, ind|
                        - unless (ind == last_index)
                          = d.destination.name
                          \-
                        - else
                          = d.destination.name
                      %br
                      = h.trip_start_date.strftime("%d-%m-%y")
                      to
                      = h.trip_end_date.strftime("%d-%m-%y")